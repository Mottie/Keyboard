/*! jQuery UI Virtual Keyboard Alt Key Popup v1.1.0 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";var b=a.keyboard;a.extend(b.css,{altKeyPopup:"ui-keyboard-popup",altKeyOverlay:"ui-keyboard-overlay"}),b.altKeys=a.extend({a:"å æ ā ă ą à á â ã ä",A:"Å Æ Ā Ă Ą À Á Â Ã Ä",c:"ç ć ĉ ċ č",C:"Ç Ć Ĉ Ċ Č",d:"ď ð ď",D:"Ď Ð Ď",e:"ė ę ĕ ě ə è é ê ë ē",E:"Ė Ę Ĕ Ě Ǝ È É Ê Ë Ē",g:"ģ ğ ĝ ġ",G:"Ģ Ğ Ĝ Ġ",h:"ĥ ħ",H:"Ĥ Ħ",i:"ı į ī ï î í ì ĩ ĭ",I:"İ Į Ī Ï Î Í Ì Ĩ Ĭ",j:"ĵ",J:"Ĵ",k:"ķ",K:"Ķ",l:"Ł Ľ Ļ Ĺ Ŀ",L:"ł ľ ļ ĺ ŀ",n:"ŉ ň ņ ń ñ",N:"ŉ Ň Ņ Ń Ñ",o:"œ ő ø ö õ ô ó ò ō ŏ",O:"Œ Ő Ø Ö Õ Ô Ó Ò Ō Ŏ",r:"ŕ ř ŗ",R:"Ŕ Ř Ŗ",s:"ś š ş ß § ŝ",S:"Ś Š Ş ẞ § Ŝ",t:"þ ť ț ţ ŧ",T:"Þ Ť Ț Ţ Ŧ",u:"ų ű ů ū ü û ú ù ũ ŭ",U:"Ų Ű Ů Ū Ü Û Ú Ù Ũ Ŭ",w:"ŵ",W:"Ŵ",y:"ý",Y:"Ý",z:"ź ż ž",Z:"Ź Ż Ž","!":"¡",$:"€ £ ¤ ¥ ¢ ₡ ₱ ₩ ₹ ₪ ₭ ₮ ₦ ₤","?":"¿","'":"〈 「 『 “",'"':"〉 」 』 ”","(":"《 【 〔",")":"》 】 〕"},b.altKeys),b.navigationKeys=a.extend({enter:13,escape:27,end:35,home:36,left:37,right:39},b.navigationKeys),a.fn.addAltKeyPopup=function(c){var d={holdTime:500,popupVisible:"popup-visible",popupHidden:"popup-hidden"};return this.each(function(){var e,f=a(this).data("keyboard");f&&(f.altkeypopup_options=a.extend({},d,c),e=f.altkeypopup_namespace=f.namespace+"AltKeyPopup",f.extensionNamespace.push(e),f.altkeypopup_setup=function(){var c,d="mousedown touchstart ".split(" ").join(e+" "),g="mouseup touchend touchcancel ".split(" ").join(e+" ");f.options.repeatRate=0,f.$allKeys.unbind(e).bind(d,function(){clearTimeout(c);var d=a(this),e=d.attr("data-value")||"";e in b.altKeys&&(c=setTimeout(function(){f.altKeyPopup_popup(e,d)},f.altkeypopup_options.holdTime))}).bind(g,function(){clearTimeout(c)}),f.altkeypopup_blockingFlag=!1,f.$preview.unbind(e).bind("keydown keyup".split(" ").join(e+" "),function(d){if("keyup"===d.type)clearTimeout(c),f.altkeypopup_blockingFlag=!1;else if(!f.altkeypopup_blockingFlag){var e=b.builtLayouts[f.layout],g=a(event.target),h=String.fromCharCode(d.charCode||d.which);return d.shiftKey||(h=h.toLowerCase()),e.hasMappedKeys&&e.mappedKeys.hasOwnProperty(h)&&(h=e.mappedKeys[h]),f.altkeypopup_blockingFlag=!0,c=setTimeout(function(){f.altKeyPopup_popup(h,g)},f.altkeypopup_options.holdTime),!0}return!1})},f.altKeyPopup_close=function(){f.altkeypopup_blockingFlag=!1,f.altKeyPopup_$overlay.remove(),a(document).unbind(e),f.$preview.focus(),f.options.ignoreEsc=f.altKeyPopup_savedIgnoreEsc,f.$el.trigger(f.altkeypopup_options.popupHidden,[f])},f.altKeyPopup_popup=function(c,d){var g,h,i,j,k,l=b.css,m=f.$keyboard.outerWidth(),n=f.$keyboard.outerHeight();f.altKeyPopup_$overlay=a('<div class="'+l.altKeyOverlay+'" />').css({width:m,height:n}).appendTo(f.$keyboard).bind("click touchstart",function(){f.altKeyPopup_close()}),"bksp"!==c&&b.keyaction.bksp(f),h=a('<div class="'+l.altKeyPopup+" "+f.options.css.container+'" />'),g=b.altKeys[c].split(/\s+/),f.buildRow(h,0,g,[]),h.appendTo(f.altKeyPopup_$overlay).children().bind("mousedown touchstart",function(c){var d=a(this).attr("data-action");d in b.keyaction&&a.isFunction(b.keyaction[d])?b.keyaction[d](f,this,c):f.insertText(d),f.altKeyPopup_$overlay.remove()}).bind("mouseover mouseleave",function(b){a(this).toggleClass(f.options.css.buttonHover,"mouseover"===b.type)}),f.last.virtual||f.altKeyPopup_navigate(!0),f.altKeyPopup_savedIgnoreEsc=f.options.ignoreEsc,f.options.ignoreEsc=!0,a(document).unbind(e).bind("keydown"+e,function(a){return!1}).bind("keyup"+e,function(a){return a.which===b.navigationKeys.escape?f.altKeyPopup_close():f.altKeyPopup_navigate(a),!1}),i=d.position().left-h.outerWidth()/2+d.outerWidth()/2,i+h.outerWidth()>m&&(i=m-h.outerWidth(),0>i&&h.css({width:m,height:"auto"})),j=d.position().top-d.outerHeight()-5,k=f.$keyboard.find("."+l.keySet).position().top,j+h.outerHeight()>n&&(j=n-h.outerHeight(),k>j&&h.css({height:n-k,width:"auto"})),h.css({position:"relative",top:k>j?k:j,left:0>i?0:i}),f.$preview.blur(),f.$el.trigger(f.altkeypopup_options.popupVisible,[f])},f.altKeyPopup_navigate=function(a){var c,d=b.css,e=b.navigationKeys,g=f.options.css.buttonHover,h=f.$keyboard.find("."+d.altKeyPopup).find("."+d.keyButton),i=h.length-1;if(a===!0)return h.eq(0).addClass(g),void(f.altKeyPopup_currentIndex=0);if(c=f.altKeyPopup_currentIndex,a.which===e.enter)return f.insertText(h.eq(c).attr("data-value")),f.altKeyPopup_close(),!0;switch(a.which){case e.end:c=i;break;case e.home:c=0;break;case e.left:c-=1;break;case e.right:c+=1}0>c&&(c=0),c>i&&(c=i),f.altKeyPopup_currentIndex=c,h.removeClass(g).eq(c).addClass(g)},f.options.alwaysOpen&&f.isVisible()&&f.altkeypopup_setup(),f.$el.unbind(b.events.kbBeforeVisible+e).bind(b.events.kbBeforeVisible+e,function(){f.altkeypopup_setup()}))})}});