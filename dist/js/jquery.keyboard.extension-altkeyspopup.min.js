/*! jQuery UI Virtual Keyboard Alt Key Popup v1.1.1 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";var b=a.keyboard;a.extend(b.css,{altKeyPopup:"ui-keyboard-popup",altKeyOverlay:"ui-keyboard-overlay"}),b.altKeys=a.extend({a:"å æ ā ă ą à á â ã ä",A:"Å Æ Ā Ă Ą À Á Â Ã Ä",c:"ç ć ĉ ċ č",C:"Ç Ć Ĉ Ċ Č",d:"ď ð ď",D:"Ď Ð Ď",e:"ė ę ĕ ě ə è é ê ë ē",E:"Ė Ę Ĕ Ě Ǝ È É Ê Ë Ē",g:"ģ ğ ĝ ġ",G:"Ģ Ğ Ĝ Ġ",h:"ĥ ħ",H:"Ĥ Ħ",i:"ı į ī ï î í ì ĩ ĭ",I:"İ Į Ī Ï Î Í Ì Ĩ Ĭ",j:"ĵ",J:"Ĵ",k:"ķ",K:"Ķ",l:"Ł Ľ Ļ Ĺ Ŀ",L:"ł ľ ļ ĺ ŀ",n:"ŉ ň ņ ń ñ",N:"ŉ Ň Ņ Ń Ñ",o:"œ ő ø ö õ ô ó ò ō ŏ",O:"Œ Ő Ø Ö Õ Ô Ó Ò Ō Ŏ",r:"ŕ ř ŗ",R:"Ŕ Ř Ŗ",s:"ś š ş ß § ŝ",S:"Ś Š Ş ẞ § Ŝ",t:"þ ť ț ţ ŧ",T:"Þ Ť Ț Ţ Ŧ",u:"ų ű ů ū ü û ú ù ũ ŭ",U:"Ų Ű Ů Ū Ü Û Ú Ù Ũ Ŭ",w:"ŵ",W:"Ŵ",y:"ý",Y:"Ý",z:"ź ż ž",Z:"Ź Ż Ž","!":"¡",$:"€ £ ¤ ¥ ¢ ₡ ₱ ₩ ₹ ₪ ₭ ₮ ₦ ₤","?":"¿","'":"〈 「 『 “",'"':"〉 」 』 ”","(":"《 【 〔",")":"》 】 〕"},b.altKeys),b.navigationKeys=a.extend({enter:13,escape:27,end:35,home:36,left:37,right:39},b.navigationKeys),a.fn.addAltKeyPopup=function(c){var d={holdTime:500,popupVisible:"popup-visible",popupHidden:"popup-hidden",popupPosition:null};return this.each(function(){var e=a(this).data("keyboard");if(e){if(e.altkeypopup_options=a.extend({},d,e.altkeypopup_options,c),e.altkeypopup_namespace)return e.altkeypopup_setup();e.altkeypopup_namespace=e.namespace+"AltKeyPopup",e.extensionNamespace.push(e.altkeypopup_namespace),e.altkeypopup_setup=function(){var c,d="mousedown touchstart ".split(" ").join(e.altkeypopup_namespace+" "),f="mouseup touchend touchcancel ".split(" ").join(e.altkeypopup_namespace+" ");e.options.repeatRate=0,e.$allKeys.unbind(e.altkeypopup_namespace).bind(d,function(){clearTimeout(c);var d=a(this),f=d.attr("data-value")||"";f in b.altKeys&&(c=setTimeout(function(){e.altKeyPopup_popup(f,d)},e.altkeypopup_options.holdTime))}).bind(f,function(){clearTimeout(c)}),e.altkeypopup_blockingFlag=!1,e.$preview.unbind("keypress keydown keyup ".split(" ").join(e.altkeypopup_namespace+" ").trim()).bind("keypress keydown keyup ".split(" ").join(e.altkeypopup_namespace+" "),function(d){if("keyup"===d.type)return clearTimeout(c),e.altkeypopup_blockingFlag=!1,!0;var f,g=b.builtLayouts[e.layout],h=b.keyCodes,i=a(d.target),j=d.charCode||d.which,k=String.fromCharCode(j);return"keydown"===d.type&&k in b.altKeys?(f=e.altkeypopup_blockingFlag,e.altkeypopup_blockingFlag=!0,!f):e.altkeypopup_blockingFlag?(j>=h.a&&j<=h.z&&!d.shiftKey&&(k=k.toLowerCase()),g.hasMappedKeys&&g.mappedKeys.hasOwnProperty(k)&&(k=g.mappedKeys[k]),k in b.altKeys&&(c=setTimeout(function(){e.altkeypopup_blockingFlag&&e.altKeyPopup_popup(k,i)},e.altkeypopup_options.holdTime)),!0):void 0})},e.altKeyPopup_close=function(){e.altkeypopup_blockingFlag=!1,e.altKeyPopup_$overlay=null,e.$keyboard.find("."+b.css.altKeyOverlay).remove(),a(document).unbind(e.altkeypopup_namespace),e.$preview.focus(),e.options.ignoreEsc=e.altKeyPopup_savedIgnoreEsc,e.$el.trigger(e.altkeypopup_options.popupHidden,[e])},e.altKeyPopup_popup=function(c,d){if(!e.$keyboard.find("."+b.css.altKeyOverlay).length){var f,g,h,i,j,k,l,m,n=b.css,o={$kb:e.$keyboard,kbWidth:e.$keyboard.outerWidth(),kbHeight:e.$keyboard.outerHeight(),$key:d};e.altKeyPopup_$overlay=a('<div class="'+n.altKeyOverlay+'" />').css({width:o.kbWidth,height:o.kbHeight}).appendTo(e.$keyboard).bind("click touchstart",function(){e.altKeyPopup_close()}),"bksp"!==c&&b.keyaction.bksp(e),g=a('<div class="'+n.altKeyPopup+" "+e.options.css.container+'" />'),f=b.altKeys[c].split(/\s+/),e.buildRow(g,0,f,[]),h=g.appendTo(e.altKeyPopup_$overlay).children().bind("mousedown touchstart",function(c){var d=a(this).attr("data-action");d in b.keyaction&&a.isFunction(b.keyaction[d])?b.keyaction[d](e,this,c):e.insertText(d),e.altKeyPopup_close()}).bind("mouseover mouseleave",function(b){"mouseleave"===b.type?h.removeClass(e.options.css.buttonHover):a(this).addClass(e.options.css.buttonHover)}),e.altKeyPopup_navigate(!0),e.altKeyPopup_savedIgnoreEsc=e.options.ignoreEsc,e.options.ignoreEsc=!0,a(document).unbind(e.altkeypopup_namespace).bind("keydown"+e.altkeypopup_namespace,function(a){return!1}).bind("keyup"+e.altkeypopup_namespace,function(a){return a.which===b.navigationKeys.escape?e.altKeyPopup_close():e.altKeyPopup_navigate(a),!1}),o.$popup=g,l=g.outerWidth(),i=d.position().left-l/2,i+l>o.kbWidth&&(i=o.kbWidth-l,i<0&&g.css({width:o.kbWidth,height:"auto"})),j=d.position().top-d.outerHeight()-5,m=g.outerHeight(),k=e.$keyboard.find("."+n.keySet).position().top,j+m>o.kbHeight&&(j=o.kbHeight-m,j<k&&g.css({height:o.popupHeight,width:"auto"})),o.popupWidth=g.outerWidth(),o.popupHeight=g.outerHeight(),o.popupLeft=i<0?0:i,o.popupTop=j<k?k:j,g.css({position:"absolute",left:o.popupLeft,top:o.popupTop}),"function"==typeof e.altkeypopup_options.popupPosition&&e.altkeypopup_options.popupPosition(e,o),e.$preview.blur(),e.$el.trigger(e.altkeypopup_options.popupVisible,[e])}},e.altKeyPopup_navigate=function(a){var c,d=b.css,f=b.navigationKeys,g=e.options.css.buttonHover,h=e.$keyboard.find("."+d.altKeyPopup).find("."+d.keyButton),i=h.length-1;if(a===!0)return h.eq(0).addClass(g),void(e.altKeyPopup_currentIndex=0);if(c=e.altKeyPopup_currentIndex,a.which===f.enter)return e.insertText(h.eq(c).attr("data-value")),e.altKeyPopup_close(),!0;switch(a.which){case f.end:c=i;break;case f.home:c=0;break;case f.left:c-=1;break;case f.right:c+=1}c<0&&(c=0),c>i&&(c=i),e.altKeyPopup_currentIndex=c,h.removeClass(g).eq(c).addClass(g)},e.options.alwaysOpen&&e.isVisible()&&e.altkeypopup_setup(),e.$el.unbind(b.events.kbBeforeVisible+e.altkeypopup_namespace).bind(b.events.kbBeforeVisible+e.altkeypopup_namespace,function(){e.altkeypopup_setup()})}})}});